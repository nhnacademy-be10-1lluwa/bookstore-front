<!DOCTYPE html>
<html layout:decorate="~{layout/layout}"
      th:lang="ko"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head layout:fragment="head" title="ν¬μΈνΈ νμ¤ν† λ¦¬">
  <link rel="stylesheet" th:href="@{/css/main.css}" />
  <link rel="stylesheet" th:href="@{/css/page/_point-history.css}" />
  <link rel="stylesheet" th:href="@{/css/component/_pagination.css}" />
  <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>

<body>
<main layout:fragment="content">
  <section class="main-content">

    <div class="point-header">
      <h1>π“ ν¬μΈνΈ νμ¤ν† λ¦¬</h1>
      <div class="current-point"
           th:text="${'<' + #numbers.formatDecimal(currentPoint, 1, 'COMMA', 0, 'POINT').replaceFirst('\\.00$', '') + ' P>'}"></div>
    </div>

    <!-- νƒ­ λ²„νΌ -->
    <div class="point-tabs">
      <a th:href="@{/point-history(type='ALL')}" class="point-tab" th:classappend="${currentType == 'ALL'} ? 'active'">μ „μ²΄</a>
      <a th:href="@{/point-history(type='EARN')}" class="point-tab" th:classappend="${currentType == 'EARN'} ? 'active'">μ λ¦½</a>
      <a th:href="@{/point-history(type='USE')}" class="point-tab" th:classappend="${currentType == 'USE'} ? 'active'">μ°¨κ°</a>
    </div>

    <!-- ν¬μΈνΈ νμ¤ν† λ¦¬ ν…μ΄λΈ” -->
    <table id="pointHistoryTable">
      <thead>
      <tr>
        <th>μΌμ‹</th>
        <th>μ ν•</th>
        <th>μ‚¬μ </th>
        <th>κΈμ•΅</th>
        <th>μ”μ•΅</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="history : ${pointHistoryList}"
          th:classappend="${history.type.name()} == 'EARN' ? 'μ λ¦½' : 'μ°¨κ°'"
          th:data-type="${history.type.name()}">
        <td th:text="${#temporals.format(history.createdAt, 'yyyy-MM-dd HH:mm')}"></td>
        <td th:text="${history.type}"></td>
        <td th:text="${history.reason}"></td>
        <td th:text="${#numbers.formatDecimal(history.amount, 1, 'COMMA', 0, 'POINT').replaceFirst('\\.00$', '') + ' P'}"></td>
        <td th:text="${#numbers.formatDecimal(history.balance, 1, 'COMMA', 0, 'POINT').replaceFirst('\\.00$', '') + ' P'}"></td>
      </tr>
      </tbody>
    </table>

    <!-- νμ΄μ§€λ„¤μ΄μ… -->
    <div class="pagination">
      <!-- μ΄μ „ λ²„νΌ -->
      <a th:if="${currentPage > 0}"
         th:href="@{/point-history(type=${currentType}, page=${currentPage - 1})}">
        β—€ μ΄μ „
      </a>

      <!-- νμ΄μ§€ λ²νΈ -->
      <span th:each="i : ${#numbers.sequence(0, lastPageIndex)}">
        <a th:href="@{/point-history(type=${currentType}, page=${i})}"
           th:text="${i + 1}"
           th:classappend="${i == currentPage} ? 'active-page' : ''">1</a>
      </span>

      <!-- λ‹¤μ λ²„νΌ -->
      <a th:if="${currentPage < lastPageIndex}"
         th:href="@{/point-history(type=${currentType}, page=${currentPage + 1})}">
        λ‹¤μ β–¶
      </a>
    </div>

  </section>
</main>
<th:block layout:fragment="scripts">
  <script th:src="@{/js/mypage/mypage.js}"></script>
</th:block>
</body>
</html>