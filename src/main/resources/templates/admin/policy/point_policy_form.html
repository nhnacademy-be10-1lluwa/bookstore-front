<!DOCTYPE html>
<html layout:decorate="~{layout/layout}"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head layout:fragment="head">
  <title>ν¬μΈνΈ μ •μ±… μƒμ„Έ</title>
  <meta charset="UTF-8" />
  <link rel="stylesheet" th:href="@{/css/main.css}" />
  <link rel="stylesheet" th:href="@{/css/page/policy/_policy_form.css}" />
</head>
<body>
<main layout:fragment="content">
  <section class="main-content policy-form-container" style="max-width: 700px; margin: 0 auto;">
    <h1 th:text="${mode == 'new' ? 'π“ ν¬μΈνΈ μ •μ±… λ“±λ΅' :
                      (mode == 'edit' ? 'π”§ ν¬μΈνΈ μ •μ±… μμ •' : 'π” ν¬μΈνΈ μ •μ±… μƒμ„Έ')}"></h1>

    <form th:action="${mode == 'new' ? '/admin/policy/point/create' :
                         '/admin/policy/point/' + policyKey + '/update'}"
          th:method="post" th:object="${request}">

      <!-- λ“±λ΅ λ¨λ“μΌ λ•λ§ policyKey μ…λ ¥ -->
      <div th:if="${mode == 'new'}" class="form-group" style="margin-bottom: 15px;">
        <label for="policyKeyInput">μ •μ±… μ½”λ“ (policyKey) <span style="color:red;">*</span></label>
        <input type="text" id="policyKeyInput" name="policyKey" th:field="*{policyKey}"
               class="form-control" placeholder="μ •μ±…μ½”λ“ μ…λ ¥" required />
      </div>

      <!-- μμ • λ¨λ“μΌ λ•λ§ readonly ν‘μ‹ -->
      <div th:if="${mode != 'new'}" class="form-group" style="margin-bottom: 15px;">
        <label>μ •μ±… μ½”λ“ (policyKey)</label>
        <input type="text" th:value="${policyKey}" readonly class="form-control"
               style="background-color: #f3f4f6; font-weight: bold; color: #334155;" />
      </div>

      <div class="form-group" th:if="${mode == 'edit'}">
        <label for="statusSwitch">μƒνƒ</label>
        <div style="display: flex; align-items: center; gap: 10px; margin-top: 8px;">
          <label class="toggle-switch" style="display: flex; align-items: center; gap: 10px;">
            <input type="checkbox" id="statusSwitch" name="active"
                   th:checked="${request.status.name() == 'ACTIVE'}"
                   th:disabled="${mode == 'view'}" />
            <span class="slider round"></span>
          </label>
          <span id="statusText" class="status-text"></span>
          <input type="hidden" name="status" id="statusValue" th:value="${request.status.name()}" />
        </div>
      </div>

      <!-- μ λ¦½ κ°’ -->
      <div class="form-group" style="margin-bottom: 15px;">
        <label>μ λ¦½ κ°’ <span th:if="${mode != 'view'}" style="color:red;">*</span></label>
        <input type="text"
               name="value"
               class="form-control"
               id="valueInput"
               th:value="${displayView}"
               required />
      </div>

      <div class="form-group" style="margin-bottom: 15px;">
        <label>μ λ¦½ μ ν• <span style="color:red;">*</span></label>
        <select th:field="*{valueType}" class="form-control"
                th:disabled="${mode == 'view'}"
                id="valueTypeSelect" required>
          <option th:value="AMOUNT">κΈμ•΅</option>
          <option th:value="RATE">λΉ„μ¨</option>
        </select>
      </div>

      <!-- μ„¤λ… -->
      <div class="form-group" style="margin-bottom: 15px;">
        <label>μ„¤λ…</label>

        <th:block th:if="${mode == 'view'}">
          <textarea th:field="*{description}" class="form-control"
                    readonly rows="4" style="resize: none;"></textarea>
        </th:block>

        <th:block th:unless="${mode == 'view'}">
          <textarea th:field="*{description}" class="form-control"
                    rows="4" style="resize: none;"></textarea>
        </th:block>
      </div>

      <div class="form-buttons" style="display: flex; gap: 10px;">
        <button type="submit" th:if="${mode != 'view'}" class="btn-register">
          <span th:text="${mode == 'new' ? 'λ“±λ΅ν•κΈ°' : 'μμ •ν•κΈ°'}">μ €μ¥</span>
        </button>
        <a href="/admin/policy/point" class="btn-delete" style="text-decoration: none; padding: 10px 20px;">
          λ©λ΅μΌλ΅
        </a>
      </div>
    </form>
  </section>
</main>
<th:block layout:fragment="scripts">
  <script th:src="@{/js/policy/coupon_policy.js}"></script>
</th:block>
</body>
</html>
